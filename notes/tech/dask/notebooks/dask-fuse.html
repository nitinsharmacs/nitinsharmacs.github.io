<!DOCTYPE html>
<html lang="en"><head><title>dask-fuse</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;family=IBM Plex Mono:wght@400;600&amp;display=swap"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="bitPhile"/><meta property="og:title" content="dask-fuse"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="dask-fuse"/><meta name="twitter:description" content="Observations HighLevelGraphs How to get the HighLevelGraph: res.data.dask or res.__dask_graph__() to get the graph in layers format."/><meta property="og:description" content="Observations HighLevelGraphs How to get the HighLevelGraph: res.data.dask or res.__dask_graph__() to get the graph in layers format."/><meta property="og:image:alt" content="Observations HighLevelGraphs How to get the HighLevelGraph: res.data.dask or res.__dask_graph__() to get the graph in layers format."/><meta property="og:image" content="https://nitinsharmacs.github.io/static/og-image.png"/><meta property="og:image:url" content="https://nitinsharmacs.github.io/static/og-image.png"/><meta name="twitter:image" content="https://nitinsharmacs.github.io/static/og-image.png"/><meta property="og:image:type" content="image/.png"/><meta property="twitter:domain" content="nitinsharmacs.github.io"/><meta property="og:url" content="https://nitinsharmacs.github.io/notes/tech/dask/notebooks/dask-fuse"/><meta property="twitter:url" content="https://nitinsharmacs.github.io/notes/tech/dask/notebooks/dask-fuse"/><link rel="icon" href="../../../../static/icon.png"/><meta name="description" content="Observations HighLevelGraphs How to get the HighLevelGraph: res.data.dask or res.__dask_graph__() to get the graph in layers format."/><meta name="generator" content="Quartz"/><link href="../../../../index.css" rel="stylesheet" type="text/css" spa-preserve/><style>.expand-button {
  position: absolute;
  display: flex;
  float: right;
  padding: 0.4rem;
  margin: 0.3rem;
  right: 0;
  color: var(--gray);
  border-color: var(--dark);
  background-color: var(--light);
  border: 1px solid;
  border-radius: 5px;
  opacity: 0;
  transition: 0.2s;
}
.expand-button > svg {
  fill: var(--light);
  filter: contrast(0.3);
}
.expand-button:hover {
  cursor: pointer;
  border-color: var(--secondary);
}
.expand-button:focus {
  outline: 0;
}

pre:hover > .expand-button {
  opacity: 1;
  transition: 0.2s;
}

#mermaid-container {
  position: fixed;
  contain: layout;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: none;
  backdrop-filter: blur(4px);
  background: rgba(0, 0, 0, 0.5);
}
#mermaid-container.active {
  display: inline-block;
}
#mermaid-container > #mermaid-space {
  border: 1px solid var(--lightgray);
  background-color: var(--light);
  border-radius: 5px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: 80vh;
  width: 80vw;
  overflow: hidden;
}
#mermaid-container > #mermaid-space > .mermaid-content {
  padding: 2rem;
  position: relative;
  transform-origin: 0 0;
  transition: transform 0.1s ease;
  overflow: visible;
  min-height: 200px;
  min-width: 200px;
}
#mermaid-container > #mermaid-space > .mermaid-content pre {
  margin: 0;
  border: none;
}
#mermaid-container > #mermaid-space > .mermaid-content svg {
  max-width: none;
  height: auto;
}
#mermaid-container > #mermaid-space > .mermaid-controls {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--light);
  border: 1px solid var(--lightgray);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 2;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid var(--lightgray);
  background: var(--light);
  color: var(--dark);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  font-family: var(--bodyFont);
  transition: all 0.2s ease;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:hover {
  background: var(--lightgray);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:active {
  transform: translateY(1px);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:nth-child(2) {
  width: auto;
  padding: 0 12px;
  font-size: 14px;
}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiL1VzZXJzL25pdGluc2hhcm1hL0xlYXJuaW5nL2Jsb2dzL2JpdHBoaWxlL3F1YXJ0ei9xdWFydHovY29tcG9uZW50cy9zdHlsZXMiLCJzb3VyY2VzIjpbIm1lcm1haWQuaW5saW5lLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7O0FBR0Y7RUFDRTtFQUNBOztBQUdGO0VBQ0U7OztBQUtGO0VBQ0U7RUFDQTs7O0FBSUo7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7O0FBR0Y7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTs7QUFHRjtFQUNFO0VBQ0E7O0FBSUo7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFOztBQUdGO0VBQ0U7O0FBSUY7RUFDRTtFQUNBO0VBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyIuZXhwYW5kLWJ1dHRvbiB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxvYXQ6IHJpZ2h0O1xuICBwYWRkaW5nOiAwLjRyZW07XG4gIG1hcmdpbjogMC4zcmVtO1xuICByaWdodDogMDsgLy8gTk9URTogcmlnaHQgd2lsbCBiZSBzZXQgaW4gbWVybWFpZC5pbmxpbmUudHNcbiAgY29sb3I6IHZhcigtLWdyYXkpO1xuICBib3JkZXItY29sb3I6IHZhcigtLWRhcmspO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodCk7XG4gIGJvcmRlcjogMXB4IHNvbGlkO1xuICBib3JkZXItcmFkaXVzOiA1cHg7XG4gIG9wYWNpdHk6IDA7XG4gIHRyYW5zaXRpb246IDAuMnM7XG5cbiAgJiA+IHN2ZyB7XG4gICAgZmlsbDogdmFyKC0tbGlnaHQpO1xuICAgIGZpbHRlcjogY29udHJhc3QoMC4zKTtcbiAgfVxuXG4gICY6aG92ZXIge1xuICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICBib3JkZXItY29sb3I6IHZhcigtLXNlY29uZGFyeSk7XG4gIH1cblxuICAmOmZvY3VzIHtcbiAgICBvdXRsaW5lOiAwO1xuICB9XG59XG5cbnByZSB7XG4gICY6aG92ZXIgPiAuZXhwYW5kLWJ1dHRvbiB7XG4gICAgb3BhY2l0eTogMTtcbiAgICB0cmFuc2l0aW9uOiAwLjJzO1xuICB9XG59XG5cbiNtZXJtYWlkLWNvbnRhaW5lciB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgY29udGFpbjogbGF5b3V0O1xuICB6LWluZGV4OiA5OTk7XG4gIGxlZnQ6IDA7XG4gIHRvcDogMDtcbiAgd2lkdGg6IDEwMHZ3O1xuICBoZWlnaHQ6IDEwMHZoO1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICBkaXNwbGF5OiBub25lO1xuICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoNHB4KTtcbiAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjUpO1xuXG4gICYuYWN0aXZlIHtcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gIH1cblxuICAmID4gI21lcm1haWQtc3BhY2Uge1xuICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tbGlnaHQpO1xuICAgIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgICBwb3NpdGlvbjogZml4ZWQ7XG4gICAgdG9wOiA1MCU7XG4gICAgbGVmdDogNTAlO1xuICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpO1xuICAgIGhlaWdodDogODB2aDtcbiAgICB3aWR0aDogODB2dztcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xuXG4gICAgJiA+IC5tZXJtYWlkLWNvbnRlbnQge1xuICAgICAgcGFkZGluZzogMnJlbTtcbiAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgIHRyYW5zZm9ybS1vcmlnaW46IDAgMDtcbiAgICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjFzIGVhc2U7XG4gICAgICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgICAgIG1pbi1oZWlnaHQ6IDIwMHB4O1xuICAgICAgbWluLXdpZHRoOiAyMDBweDtcblxuICAgICAgcHJlIHtcbiAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICBib3JkZXI6IG5vbmU7XG4gICAgICB9XG5cbiAgICAgIHN2ZyB7XG4gICAgICAgIG1heC13aWR0aDogbm9uZTtcbiAgICAgICAgaGVpZ2h0OiBhdXRvO1xuICAgICAgfVxuICAgIH1cblxuICAgICYgPiAubWVybWFpZC1jb250cm9scyB7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICBib3R0b206IDIwcHg7XG4gICAgICByaWdodDogMjBweDtcbiAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICBnYXA6IDhweDtcbiAgICAgIHBhZGRpbmc6IDhweDtcbiAgICAgIGJhY2tncm91bmQ6IHZhcigtLWxpZ2h0KTtcbiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgICBib3JkZXItcmFkaXVzOiA2cHg7XG4gICAgICBib3gtc2hhZG93OiAwIDJweCA0cHggcmdiYSgwLCAwLCAwLCAwLjEpO1xuICAgICAgei1pbmRleDogMjtcblxuICAgICAgLm1lcm1haWQtY29udHJvbC1idXR0b24ge1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgd2lkdGg6IDMycHg7XG4gICAgICAgIGhlaWdodDogMzJweDtcbiAgICAgICAgcGFkZGluZzogMDtcbiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHQpO1xuICAgICAgICBjb2xvcjogdmFyKC0tZGFyayk7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICBmb250LXNpemU6IDE2cHg7XG4gICAgICAgIGZvbnQtZmFtaWx5OiB2YXIoLS1ib2R5Rm9udCk7XG4gICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XG5cbiAgICAgICAgJjpob3ZlciB7XG4gICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgICAgfVxuXG4gICAgICAgICY6YWN0aXZlIHtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMXB4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFN0eWxlIHRoZSByZXNldCBidXR0b24gZGlmZmVyZW50bHlcbiAgICAgICAgJjpudGgtY2hpbGQoMikge1xuICAgICAgICAgIHdpZHRoOiBhdXRvO1xuICAgICAgICAgIHBhZGRpbmc6IDAgMTJweDtcbiAgICAgICAgICBmb250LXNpemU6IDE0cHg7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiJdfQ== */</style><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../../../../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../../../../static/contentIndex.json").then(data => data.json())</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://nitinsharmacs.github.io/index.xml"/></head><body data-slug="notes/tech/dask/notebooks/dask-fuse"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="../../../..">bitPhile</a></h2><div class="spacer mobile-only"></div><div style="display: flex; flex-direction: row; flex-wrap: nowrap; gap: 1rem;"><div style="flex-grow: 1; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><div class="search"><button class="search-button"><p>Search</p><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></button><div class="search-container"><div class="search-space"><input autocomplete="off" class="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div class="search-layout" data-preview="true"></div></div></div></div></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div></div><div class="explorer" data-behavior="link" data-collapsed="collapsed" data-savestate="true" data-data-fns="{&quot;order&quot;:[&quot;filter&quot;,&quot;map&quot;,&quot;sort&quot;],&quot;sortFn&quot;:&quot;(a,b)=>!a.isFolder&amp;&amp;!b.isFolder||a.isFolder&amp;&amp;b.isFolder?a.displayName.localeCompare(b.displayName,void 0,{numeric:!0,sensitivity:\&quot;base\&quot;}):!a.isFolder&amp;&amp;b.isFolder?1:-1&quot;,&quot;filterFn&quot;:&quot;node=>node.slugSegment!==\&quot;tags\&quot;&quot;,&quot;mapFn&quot;:&quot;node=>node&quot;}"><button type="button" class="explorer-toggle mobile-explorer hide-until-loaded" data-mobile="true" aria-controls="explorer-content"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><button type="button" class="title-button explorer-toggle desktop-explorer" data-mobile="false" aria-expanded="true"><h2>Explorer</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div class="explorer-content" aria-expanded="false"><ul class="explorer-ul overflow" id="list-0"><li class="overflow-end"></li></ul></div><template id="template-file"><li><a href="#"></a></li></template><template id="template-folder"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div><button class="folder-button"><span class="folder-title"></span></button></div></div><div class="folder-outer"><ul class="content"></ul></div></li></template></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../../../../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../../../notes/">notes</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../../../notes/tech/">tech</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../../../notes/tech/dask/">dask</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../../../notes/tech/dask/notebooks/">notebooks</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>dask fuse</a></div></nav><h1 class="article-title">dask-fuse</h1><p show-comma="true" class="content-meta"><time datetime="2024-12-09T18:14:35.057Z">Dec 09, 2024</time><span>26 min read</span></p><ul class="tags"><li><a href="../../../../tags/e0e0e0" class="internal tag-link">e0e0e0</a></li><li><a href="../../../../tags/bdbdbd" class="internal tag-link">bdbdbd</a></li><li><a href="../../../../tags/eeeeee" class="internal tag-link">eeeeee</a></li><li><a href="../../../../tags/1F1F1F" class="internal tag-link">1F1F1F</a></li></ul></div></div><article class="popover-hint"><h3 id="observations">Observations<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#observations" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>HighLevelGraphs</strong></p>
<p>How to get the HighLevelGraph:</p>
<ul>
<li>
<p><code>res.data.dask</code> or <code>res.__dask_graph__()</code> to get the graph in layers format.</p>
</li>
<li>
<p><code>res.data.dask.visualize()</code> or <code>res.__dask_graph__().visualize()</code> to get in graph format.</p>
</li>
</ul>
<p>Internals:</p>
<ul>
<li>
<p>HLG is a dict, <code>res.data.dask.__dict__</code>. It has the nodes and keys of the task graphs. (which is basically the low level graph’s nodes)</p>
</li>
<li>
<p><code>res.data.dask.dependencies</code> to get the layers, dependencies and key_dependencies.</p>
</li>
<li>
<p><code>res.__dask_graph__().keys</code>  or <code>res.data.dask.keys</code> would give the layers as keys. (res.data.dask.values also gives the same, i.e keys and values are same)</p>
</li>
<li>
<p>On <code>res.data.dask.</code> we can perform these operations [cull, merge, cull_layers, validate, get, copy, dependents, get_all_dependencies, visualize].</p>
</li>
</ul>
<p>Notes:</p>
<ul>
<li><code>type(dask.visualize(res))</code> this gets the low level graph, but the type is an Image. <code>type(res.data.dask)</code> this gets the HLG, and the type is also HLG.</li>
</ul>
<h3 id="fuse-and-highlevelgraph">Fuse and HighLevelGraph<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#fuse-and-highlevelgraph" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># from dask.distributed import Client</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># client = Client(address = &quot;tcp://192.168.0.100:8786&quot;)</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># client</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xarray </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xr</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dask.array </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> da</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> numpy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># (a+b)^2 = a^2 + b^2 + 2ab</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> da.from_array([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">chunks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> da.from_array([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">chunks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">xr_a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xr.DataArray(a)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">xr_b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xr.DataArray(b)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(arr1, arr2):</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arr1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arr2</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sq</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(arr):</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mul</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(arr1, arr2):</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arr1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arr2</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">a_sq </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sq(xr_a) </span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b_sq </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sq(xr_b)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">add_ab </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> add(a_sq, b_sq) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># a^2 +b^2</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mul_ab </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mul(xr_a, xr_b) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ab</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> add(add_ab, mul_ab)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># res.__dask_layers__() -> dk</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># dask.visualize(res) -> low level graphs</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># dask.optimize(a)</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># a.npartitions # gives no.of chunks</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># a.chunksize # gives chunk size</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># res.__dask_keys__() -> dont know the real reason behind the keys</span></span>
<span data-line> </span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># compute </span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># dask delayed</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># from_collections()</span></span>
<span data-line> </span></code></pre></figure>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">res.compute()</span></span></code></pre></figure>
<div><svg style="position:absolute;width:0;height:0;overflow:hidden;">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */
:root {
—xr-font-color0: var(—jp-content-font-color0, rgba(0, 0, 0, 1));
—xr-font-color2: var(—jp-content-font-color2, rgba(0, 0, 0, 0.54));
—xr-font-color3: var(—jp-content-font-color3, rgba(0, 0, 0, 0.38));
—xr-border-color: var(—jp-border-color2, e0e0e0</style>);
—xr-disabled-color: var(—jp-layout-color3, <a href="../../../../tags/bdbdbd" class="tag-link internal alias" data-slug="tags/bdbdbd">bdbdbd</a>);
—xr-background-color: var(—jp-layout-color0, white);
—xr-background-color-row-even: var(—jp-layout-color1, white);
—xr-background-color-row-odd: var(—jp-layout-color2, <a href="../../../../tags/eeeeee" class="tag-link internal alias" data-slug="tags/eeeeee">eeeeee</a>);
}<p></p>
<p>html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
—xr-font-color0: rgba(255, 255, 255, 1);
—xr-font-color2: rgba(255, 255, 255, 0.54);
—xr-font-color3: rgba(255, 255, 255, 0.38);
—xr-border-color: <a href="../../../../tags/1F1F1F" class="tag-link internal alias" data-slug="tags/1F1F1F">1F1F1F</a>;
—xr-disabled-color: #515151;
—xr-background-color: #111111;
—xr-background-color-row-even: #111111;
—xr-background-color-row-odd: #313131;
}</p>
<p>.xr-wrap {
display: block !important;
min-width: 300px;
max-width: 700px;
}</p>
<p>.xr-text-repr-fallback {
/* fallback to plain text repr when CSS is not injected (untrusted notebook) */
display: none;
}</p>
<p>.xr-header {
padding-top: 6px;
padding-bottom: 6px;
margin-bottom: 4px;
border-bottom: solid 1px var(—xr-border-color);
}</p>
<p>.xr-header > div,
.xr-header > ul {
display: inline;
margin-top: 0;
margin-bottom: 0;
}</p>
<p>.xr-obj-type,
.xr-array-name {
margin-left: 2px;
margin-right: 10px;
}</p>
<p>.xr-obj-type {
color: var(—xr-font-color2);
}</p>
<p>.xr-sections {
padding-left: 0 !important;
display: grid;
grid-template-columns: 150px auto auto 1fr 20px 20px;
}</p>
<p>.xr-section-item {
display: contents;
}</p>
<p>.xr-section-item input {
display: none;
}</p>
<p>.xr-section-item input + label {
color: var(—xr-disabled-color);
}</p>
<p>.xr-section-item input:enabled + label {
cursor: pointer;
color: var(—xr-font-color2);
}</p>
<p>.xr-section-item input:enabled + label:hover {
color: var(—xr-font-color0);
}</p>
<p>.xr-section-summary {
grid-column: 1;
color: var(—xr-font-color2);
font-weight: 500;
}</p>
<p>.xr-section-summary > span {
display: inline-block;
padding-left: 0.5em;
}</p>
<p>.xr-section-summary-in:disabled + label {
color: var(—xr-font-color2);
}</p>
<p>.xr-section-summary-in + label:before {
display: inline-block;
content: ’►’;
font-size: 11px;
width: 15px;
text-align: center;
}</p>
<p>.xr-section-summary-in:disabled + label:before {
color: var(—xr-disabled-color);
}</p>
<p>.xr-section-summary-in:checked + label:before {
content: ’▼’;
}</p>
<p>.xr-section-summary-in:checked + label > span {
display: none;
}</p>
<p>.xr-section-summary,
.xr-section-inline-details {
padding-top: 4px;
padding-bottom: 4px;
}</p>
<p>.xr-section-inline-details {
grid-column: 2 / -1;
}</p>
<p>.xr-section-details {
display: none;
grid-column: 1 / -1;
margin-bottom: 5px;
}</p>
<p>.xr-section-summary-in:checked ~ .xr-section-details {
display: contents;
}</p>
<p>.xr-array-wrap {
grid-column: 1 / -1;
display: grid;
grid-template-columns: 20px auto;
}</p>
<p>.xr-array-wrap > label {
grid-column: 1;
vertical-align: top;
}</p>
<p>.xr-preview {
color: var(—xr-font-color3);
}</p>
<p>.xr-array-preview,
.xr-array-data {
padding: 0 5px !important;
grid-column: 2;
}</p>
<p>.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
display: none;
}</p>
<p>.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
display: inline-block;
}</p>
<p>.xr-dim-list {
display: inline-block !important;
list-style: none;
padding: 0 !important;
margin: 0;
}</p>
<p>.xr-dim-list li {
display: inline-block;
padding: 0;
margin: 0;
}</p>
<p>.xr-dim-list:before {
content: ’(’;
}</p>
<p>.xr-dim-list:after {
content: ’)’;
}</p>
<p>.xr-dim-list li:not(:last-child):after {
content: ’,’;
padding-right: 5px;
}</p>
<p>.xr-has-index {
font-weight: bold;
}</p>
<p>.xr-var-list,
.xr-var-item {
display: contents;
}</p>
<p>.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
background-color: var(—xr-background-color-row-even);
margin-bottom: 0;
}</p>
<p>.xr-var-item > .xr-var-name:hover span {
padding-right: 5px;
}</p>
<p>.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
background-color: var(—xr-background-color-row-odd);
}</p>
<p>.xr-var-name {
grid-column: 1;
}</p>
<p>.xr-var-dims {
grid-column: 2;
}</p>
<p>.xr-var-dtype {
grid-column: 3;
text-align: right;
color: var(—xr-font-color2);
}</p>
<p>.xr-var-preview {
grid-column: 4;
}</p>
<p>.xr-index-preview {
grid-column: 2 / 5;
color: var(—xr-font-color2);
}</p>
<p>.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
padding-right: 10px;
}</p>
<p>.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
overflow: visible;
width: auto;
z-index: 1;
}</p>
<p>.xr-var-attrs,
.xr-var-data,
.xr-index-data {
display: none;
background-color: var(—xr-background-color) !important;
padding-bottom: 5px !important;
}</p>
<p>.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
display: block;
}</p>
<p>.xr-var-data > table {
float: right;
}</p>
<p>.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
padding-left: 25px !important;
}</p>
<p>.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
grid-column: 1 / -1;
}</p>
<p>dl.xr-attrs {
padding: 0;
margin: 0;
display: grid;
grid-template-columns: 125px auto;
}</p>
<p>.xr-attrs dt,
.xr-attrs dd {
padding: 0;
margin: 0;
float: left;
padding-right: 10px;
width: auto;
}</p>
<p>.xr-attrs dt {
font-weight: normal;
grid-column: 1;
}</p>
<p>.xr-attrs dt:hover span {
display: inline-block;
background: var(—xr-background-color);
padding-right: 10px;
}</p>
<p>.xr-attrs dd {
grid-column: 2;
white-space: pre-wrap;
word-break: break-all;
}</p>
<p>.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
display: inline-block;
vertical-align: middle;
width: 1em;
height: 1.5em !important;
stroke-width: 0;
stroke: currentColor;
fill: currentColor;
}
</p><pre class="xr-text-repr-fallback">&lt;xarray.DataArray (dim_0: 4)> Size: 32B
array([ 31,  52,  79, 112])
Dimensions without coordinates: dim_0</pre><div class="xr-wrap" style="display:none;"><div class="xr-header"><div class="xr-obj-type">xarray.DataArray</div><div class="xr-array-name"></div><ul class="xr-dim-list"><li><span>dim_0</span>: 4</li></ul></div><ul class="xr-sections"><li class="xr-section-item"><div class="xr-array-wrap"><input id="section-ed64e719-2209-4977-af22-4254b23d8778" class="xr-array-in" type="checkbox" checked/><label for="section-ed64e719-2209-4977-af22-4254b23d8778" title="Show/hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>31 52 79 112</span></div><div class="xr-array-data"><pre>array([ 31,  52,  79, 112])</pre></div></div></li><li class="xr-section-item"><input id="section-e8fbd8a6-5745-42eb-a9d2-4ae82b26377f" class="xr-section-summary-in" type="checkbox" disabled/><label for="section-e8fbd8a6-5745-42eb-a9d2-4ae82b26377f" class="xr-section-summary" title="Expand/collapse section">Coordinates: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-34ce46b0-9114-4225-9d75-215952ec2fb4" class="xr-section-summary-in" type="checkbox" disabled/><label for="section-34ce46b0-9114-4225-9d75-215952ec2fb4" class="xr-section-summary" title="Expand/collapse section">Indexes: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-d5d3dc16-9c71-4f36-9e6d-cea7880cfd61" class="xr-section-summary-in" type="checkbox" disabled/><label for="section-d5d3dc16-9c71-4f36-9e6d-cea7880cfd61" class="xr-section-summary" title="Expand/collapse section">Attributes: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"></dl></div></li></ul></div></div><p></p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">res.data.dask.visualize()</span></span></code></pre></figure>
<p><img src="./dask-fuse_files/dask-fuse_7_0.svg" alt="svg"/></p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dask</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> res.data.dask</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hlg_keys </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> res.data.dask.keys</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dask.threaded </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> get</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dask.optimization </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fuse, fuse_linear</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">outputs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;add-ffe880f167c9131320013be9069dfca1&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph2, dep </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fuse(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(graph), </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fuse_subgraphs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">keys </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> graph2.keys()</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(keys)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">get(graph2, (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'add-ffe880f167c9131320013be9069dfca1'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></figure>
<pre><code>dict_keys([('add-ffe880f167c9131320013be9069dfca1', 0), ('add-ffe880f167c9131320013be9069dfca1', 1), ('add-ffe880f167c9131320013be9069dfca1', 2), ('add-ffe880f167c9131320013be9069dfca1', 3), ('add-d8368b0c413b7b1ff3e4545d5d219543', 0), ('add-d8368b0c413b7b1ff3e4545d5d219543', 1), ('add-d8368b0c413b7b1ff3e4545d5d219543', 2), ('add-d8368b0c413b7b1ff3e4545d5d219543', 3), ('array-93fac394d6028ca1841a0aaaf012fdfd', 0), ('array-93fac394d6028ca1841a0aaaf012fdfd', 1), ('array-93fac394d6028ca1841a0aaaf012fdfd', 2), ('array-93fac394d6028ca1841a0aaaf012fdfd', 3), ('pow-f98325ba6ded8b13c46607d966ba51d1', 0), ('pow-f98325ba6ded8b13c46607d966ba51d1', 1), ('pow-f98325ba6ded8b13c46607d966ba51d1', 2), ('pow-f98325ba6ded8b13c46607d966ba51d1', 3), ('array-e0289449abd23dc644f0fd074cd695dc', 0), ('array-e0289449abd23dc644f0fd074cd695dc', 1), ('array-e0289449abd23dc644f0fd074cd695dc', 2), ('array-e0289449abd23dc644f0fd074cd695dc', 3), ('pow-5022bc0a56d6e28f1fd172a750ba8cff', 0), ('pow-5022bc0a56d6e28f1fd172a750ba8cff', 1), ('pow-5022bc0a56d6e28f1fd172a750ba8cff', 2), ('pow-5022bc0a56d6e28f1fd172a750ba8cff', 3), ('mul-8e9e32e19f9c6e612b3800864d8cc810', 0), ('mul-8e9e32e19f9c6e612b3800864d8cc810', 1), ('mul-8e9e32e19f9c6e612b3800864d8cc810', 2), ('mul-8e9e32e19f9c6e612b3800864d8cc810', 3)])





array([31])
</code></pre>
<h3 id="call-delayed-on-hlg">Call delayed on HLG<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#call-delayed-on-hlg" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dask.delayed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Delayed, delayed</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">root_key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;add-ffe880f167c9131320013be9069dfca1&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">g1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> graph</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> delayed(graph)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result.compute()</span></span></code></pre></figure>
<div>
    <div>
        <div style="width:52px;height:52px;position:absolute;">
            <svg width="76" height="71" viewBox="0 0 76 71" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="61.5" cy="36.5" r="13.5" style="stroke:var(--jp-ui-font-color2, #1D1D1D);fill:var(--jp-layout-color1, #F2F2F2);" stroke-width="2"></circle>
                <circle cx="14.5" cy="14.5" r="13.5" style="stroke:var(--jp-ui-font-color2, #1D1D1D);fill:var(--jp-layout-color1, #F2F2F2);" stroke-width="2"></circle>
                <circle cx="14.5" cy="56.5" r="13.5" style="stroke:var(--jp-ui-font-color2, #1D1D1D);fill:var(--jp-layout-color1, #F2F2F2);" stroke-width="2"></circle>
                <path d="M28 16L30.5 16C33.2614 16 35.5 18.2386 35.5 21L35.5 32.0001C35.5 34.7615 37.7386 37.0001 40.5 37.0001L43 37.0001" style="stroke:var(--jp-ui-font-color2, #1D1D1D);" stroke-width="1.5"></path>
                <path d="M40.5 37L40.5 37.75L40.5 37.75L40.5 37ZM35.5 42L36.25 42L35.5 42ZM35.5 52L34.75 52L35.5 52ZM30.5 57L30.5 57.75L30.5 57ZM41.5001 36.25L40.5 36.25L40.5 37.75L41.5001 37.75L41.5001 36.25ZM34.75 42L34.75 52L36.25 52L36.25 42L34.75 42ZM30.5 56.25L28.0001 56.25L28.0001 57.75L30.5 57.75L30.5 56.25ZM34.75 52C34.75 54.3472 32.8472 56.25 30.5 56.25L30.5 57.75C33.6756 57.75 36.25 55.1756 36.25 52L34.75 52ZM40.5 36.25C37.3244 36.25 34.75 38.8243 34.75 42L36.25 42C36.25 39.6528 38.1528 37.75 40.5 37.75L40.5 36.25Z" style="fill:var(--jp-ui-font-color2, #1D1D1D);"></path>
                <circle cx="28" cy="16" r="2.25" fill="#E5E5E5" style="stroke:var(--jp-ui-font-color2, #1D1D1D);" stroke-width="1.5"></circle>
                <circle cx="28" cy="57" r="2.25" fill="#E5E5E5" style="stroke:var(--jp-ui-font-color2, #1D1D1D);" stroke-width="1.5"></circle>
                <path d="M45.25 36.567C45.5833 36.7594 45.5833 37.2406 45.25 37.433L42.25 39.1651C41.9167 39.3575 41.5 39.117 41.5 38.7321V35.2679C41.5 34.883 41.9167 34.6425 42.25 34.8349L45.25 36.567Z" style="fill:var(--jp-ui-font-color2, #1D1D1D);"></path>
            </svg>
        </div>
        <div style="margin-left:64px;">
            <h3 style="margin-bottom:0px;" id="highlevelgraph">HighLevelGraph<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#highlevelgraph" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
            <p style="color:var(--jp-ui-font-color2, #5D5851);margin-bottom:0px;">
                HighLevelGraph with 7 layers and 28 keys from all layers.
            </p>
<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer1: array&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        array-e0289449abd23dc644f0fd074cd695dc
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>MaterializedLayer&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>4&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>shape&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(4,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>dtype&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>int64&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunksize&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(1,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>dask.array.core.Array&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunk_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>numpy.ndarray&lt;/td>
                &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>
            &lt;svg width=&quot;250&quot; height=&quot;121&quot; style=&quot;stroke:rgb(0,0,0);stroke-width:1&quot; >
</code></pre>
  
  <line x1="0" y1="0" x2="200" y2="0" style="stroke-width:2;">
  <line x1="0" y1="71" x2="200" y2="71" style="stroke-width:2;">
  
  <line x1="0" y1="0" x2="0" y2="71" style="stroke-width:2;">
  <line x1="50" y1="0" x2="50" y2="71">
  <line x1="100" y1="0" x2="100" y2="71">
  <line x1="150" y1="0" x2="150" y2="71">
  <line x1="200" y1="0" x2="200" y2="71" style="stroke-width:2;">
  
  <polygon points="0.0,0.0 200.0,0.0 200.0,71.49799253643671 0.0,71.49799253643671" style="fill:#ECB172A0;stroke-width:0;">
  
<p><text x="100.000000" y="91.497993" font-size="1.0rem" font-weight="100" text-anchor="middle">4</text>
<text x="220.000000" y="35.748996" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,220.000000,35.748996)">1</text>



</p>
<pre><code>&lt;/details>
</code></pre>
</polygon></line></line></line></line></line></line></line></div>
<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer2: pow&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        pow-5022bc0a56d6e28f1fd172a750ba8cff
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>Blockwise&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>4&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>shape&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(4,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>dtype&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>int64&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunksize&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(1,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>dask.array.core.Array&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunk_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>numpy.ndarray&lt;/td>
                &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;> depends on &lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>array-e0289449abd23dc644f0fd074cd695dc&lt;/td>
                    &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>
            &lt;svg width=&quot;250&quot; height=&quot;121&quot; style=&quot;stroke:rgb(0,0,0);stroke-width:1&quot; >
</code></pre>
  
  <line x1="0" y1="0" x2="200" y2="0" style="stroke-width:2;">
  <line x1="0" y1="71" x2="200" y2="71" style="stroke-width:2;">
  
  <line x1="0" y1="0" x2="0" y2="71" style="stroke-width:2;">
  <line x1="50" y1="0" x2="50" y2="71">
  <line x1="100" y1="0" x2="100" y2="71">
  <line x1="150" y1="0" x2="150" y2="71">
  <line x1="200" y1="0" x2="200" y2="71" style="stroke-width:2;">
  
  <polygon points="0.0,0.0 200.0,0.0 200.0,71.49799253643671 0.0,71.49799253643671" style="fill:#ECB172A0;stroke-width:0;">
  
<p><text x="100.000000" y="91.497993" font-size="1.0rem" font-weight="100" text-anchor="middle">4</text>
<text x="220.000000" y="35.748996" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,220.000000,35.748996)">1</text>



</p>
<pre><code>&lt;/details>
</code></pre>
</polygon></line></line></line></line></line></line></line></div>
<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer3: array&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        array-93fac394d6028ca1841a0aaaf012fdfd
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>MaterializedLayer&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>4&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>shape&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(4,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>dtype&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>int64&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunksize&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(1,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>dask.array.core.Array&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunk_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>numpy.ndarray&lt;/td>
                &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>
            &lt;svg width=&quot;250&quot; height=&quot;121&quot; style=&quot;stroke:rgb(0,0,0);stroke-width:1&quot; >
</code></pre>
  
  <line x1="0" y1="0" x2="200" y2="0" style="stroke-width:2;">
  <line x1="0" y1="71" x2="200" y2="71" style="stroke-width:2;">
  
  <line x1="0" y1="0" x2="0" y2="71" style="stroke-width:2;">
  <line x1="50" y1="0" x2="50" y2="71">
  <line x1="100" y1="0" x2="100" y2="71">
  <line x1="150" y1="0" x2="150" y2="71">
  <line x1="200" y1="0" x2="200" y2="71" style="stroke-width:2;">
  
  <polygon points="0.0,0.0 200.0,0.0 200.0,71.49799253643671 0.0,71.49799253643671" style="fill:#ECB172A0;stroke-width:0;">
  
<p><text x="100.000000" y="91.497993" font-size="1.0rem" font-weight="100" text-anchor="middle">4</text>
<text x="220.000000" y="35.748996" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,220.000000,35.748996)">1</text>



</p>
<pre><code>&lt;/details>
</code></pre>
</polygon></line></line></line></line></line></line></line></div>
<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer4: mul&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        mul-8e9e32e19f9c6e612b3800864d8cc810
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>Blockwise&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>4&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>shape&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(4,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>dtype&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>int64&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunksize&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(1,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>dask.array.core.Array&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunk_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>numpy.ndarray&lt;/td>
                &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;> depends on &lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>array-93fac394d6028ca1841a0aaaf012fdfd&lt;/td>
                    &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;>&lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>array-e0289449abd23dc644f0fd074cd695dc&lt;/td>
                    &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>
            &lt;svg width=&quot;250&quot; height=&quot;121&quot; style=&quot;stroke:rgb(0,0,0);stroke-width:1&quot; >
</code></pre>
  
  <line x1="0" y1="0" x2="200" y2="0" style="stroke-width:2;">
  <line x1="0" y1="71" x2="200" y2="71" style="stroke-width:2;">
  
  <line x1="0" y1="0" x2="0" y2="71" style="stroke-width:2;">
  <line x1="50" y1="0" x2="50" y2="71">
  <line x1="100" y1="0" x2="100" y2="71">
  <line x1="150" y1="0" x2="150" y2="71">
  <line x1="200" y1="0" x2="200" y2="71" style="stroke-width:2;">
  
  <polygon points="0.0,0.0 200.0,0.0 200.0,71.49799253643671 0.0,71.49799253643671" style="fill:#ECB172A0;stroke-width:0;">
  
<p><text x="100.000000" y="91.497993" font-size="1.0rem" font-weight="100" text-anchor="middle">4</text>
<text x="220.000000" y="35.748996" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,220.000000,35.748996)">1</text>



</p>
<pre><code>&lt;/details>
</code></pre>

<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer5: pow&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        pow-f98325ba6ded8b13c46607d966ba51d1
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>Blockwise&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>4&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>shape&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(4,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>dtype&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>int64&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunksize&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(1,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>dask.array.core.Array&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunk_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>numpy.ndarray&lt;/td>
                &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;> depends on &lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>array-93fac394d6028ca1841a0aaaf012fdfd&lt;/td>
                    &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>
            &lt;svg width=&quot;250&quot; height=&quot;121&quot; style=&quot;stroke:rgb(0,0,0);stroke-width:1&quot; >
</code></pre>
  
  <line x1="0" y1="0" x2="200" y2="0" style="stroke-width:2;">
  <line x1="0" y1="71" x2="200" y2="71" style="stroke-width:2;">
  
  <line x1="0" y1="0" x2="0" y2="71" style="stroke-width:2;">
  <line x1="50" y1="0" x2="50" y2="71">
  <line x1="100" y1="0" x2="100" y2="71">
  <line x1="150" y1="0" x2="150" y2="71">
  <line x1="200" y1="0" x2="200" y2="71" style="stroke-width:2;">
  
  <polygon points="0.0,0.0 200.0,0.0 200.0,71.49799253643671 0.0,71.49799253643671" style="fill:#ECB172A0;stroke-width:0;">
  
<p><text x="100.000000" y="91.497993" font-size="1.0rem" font-weight="100" text-anchor="middle">4</text>
<text x="220.000000" y="35.748996" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,220.000000,35.748996)">1</text>



</p>
<pre><code>&lt;/details>
</code></pre>

<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer6: add&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        add-d8368b0c413b7b1ff3e4545d5d219543
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>Blockwise&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>4&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>shape&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(4,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>dtype&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>int64&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunksize&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(1,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>dask.array.core.Array&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunk_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>numpy.ndarray&lt;/td>
                &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;> depends on &lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>pow-5022bc0a56d6e28f1fd172a750ba8cff&lt;/td>
                    &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;>&lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>pow-f98325ba6ded8b13c46607d966ba51d1&lt;/td>
                    &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>
            &lt;svg width=&quot;250&quot; height=&quot;121&quot; style=&quot;stroke:rgb(0,0,0);stroke-width:1&quot; >
</code></pre>
  
  <line x1="0" y1="0" x2="200" y2="0" style="stroke-width:2;">
  <line x1="0" y1="71" x2="200" y2="71" style="stroke-width:2;">
  
  <line x1="0" y1="0" x2="0" y2="71" style="stroke-width:2;">
  <line x1="50" y1="0" x2="50" y2="71">
  <line x1="100" y1="0" x2="100" y2="71">
  <line x1="150" y1="0" x2="150" y2="71">
  <line x1="200" y1="0" x2="200" y2="71" style="stroke-width:2;">
  
  <polygon points="0.0,0.0 200.0,0.0 200.0,71.49799253643671 0.0,71.49799253643671" style="fill:#ECB172A0;stroke-width:0;">
  
<p><text x="100.000000" y="91.497993" font-size="1.0rem" font-weight="100" text-anchor="middle">4</text>
<text x="220.000000" y="35.748996" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,220.000000,35.748996)">1</text>



</p>
<pre><code>&lt;/details>
</code></pre>

<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer7: add&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        add-ffe880f167c9131320013be9069dfca1
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>Blockwise&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>4&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>shape&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(4,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>dtype&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>int64&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunksize&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(1,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>dask.array.core.Array&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunk_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>numpy.ndarray&lt;/td>
                &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;> depends on &lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>add-d8368b0c413b7b1ff3e4545d5d219543&lt;/td>
                    &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;>&lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>mul-8e9e32e19f9c6e612b3800864d8cc810&lt;/td>
                    &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>
            &lt;svg width=&quot;250&quot; height=&quot;121&quot; style=&quot;stroke:rgb(0,0,0);stroke-width:1&quot; >
</code></pre>
  
  <line x1="0" y1="0" x2="200" y2="0" style="stroke-width:2;">
  <line x1="0" y1="71" x2="200" y2="71" style="stroke-width:2;">
  
  <line x1="0" y1="0" x2="0" y2="71" style="stroke-width:2;">
  <line x1="50" y1="0" x2="50" y2="71">
  <line x1="100" y1="0" x2="100" y2="71">
  <line x1="150" y1="0" x2="150" y2="71">
  <line x1="200" y1="0" x2="200" y2="71" style="stroke-width:2;">
  
  <polygon points="0.0,0.0 200.0,0.0 200.0,71.49799253643671 0.0,71.49799253643671" style="fill:#ECB172A0;stroke-width:0;">
  
<p><text x="100.000000" y="91.497993" font-size="1.0rem" font-weight="100" text-anchor="middle">4</text>
<text x="220.000000" y="35.748996" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,220.000000,35.748996)">1</text>



</p>
<pre><code>&lt;/details>
</code></pre>

<pre><code>    &lt;/div>
&lt;/div>
</code></pre>

<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># https://github.com/ska-sa/katsdpcal/blob/e13c3442ae7be050a7455bc384116aae8e082895/katsdpcal/inplace.py#L250</span></span>
<span data-line> </span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Returns equivalent dask collections that all share the same merged and</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># optimized underlying graph. This can be useful if converting multiple</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># collections to delayed objects, or to manually apply the optimizations at</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># strategic points.  </span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># https://github.com/dask/dask/blob/aafde77e5c7f5220775635a0035c7ae64310ed3a/dask/base.py#L588</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># def repack(results):</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#         dsk = repack_dsk.copy()</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#         dsk[collections_token] = quote(results)</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#         return simple_get(dsk, out)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Quote: Ensure that this value remains this value in a dask graph https://github.com/dask/dask/blob/main/dask/core.py#L515</span></span>
<span data-line> </span></code></pre></figure>
<h3 id="dask-delayed-and-fuse">dask delayed and fuse<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#dask-delayed-and-fuse" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xarray </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xr</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dask.array </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> da</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> numpy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># (a+b)^2 = a^2 + b^2 + 2ab</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> da.from_array([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">chunks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> da.from_array([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">chunks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">xr_a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xr.DataArray(a)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">xr_b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xr.DataArray(b)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@dask.delayed</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> add_d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(arr1, arr2):</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arr1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arr2</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@dask.delayed</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sq_d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(arr):</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@dask.delayed</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mul_d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(arr1, arr2):</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arr1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arr2</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">a_sq </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sq_d(xr_a) </span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b_sq </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sq_d(xr_b)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">add_ab </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> add_d(a_sq, b_sq) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># a^2 +b^2</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mul_ab </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mul_d(xr_a, xr_b) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ab</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">res_d </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> add(add_ab, mul_ab)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">delayed_hgl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> res_d.data.dask</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">delayed_hgl.visualize()</span></span></code></pre></figure>
<p><img src="./dask-fuse_files/dask-fuse_15_0.svg" alt="svg"/></p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(delayed_hgl)</span></span></code></pre></figure>
<pre><code>{'add-a362066893b349d99b2b19a5d658fccb': (&lt;function _operator.add(a, b, /)>,
  'add_d-a0be0541-c05e-46af-b8c5-df5fb17eea90',
  'mul_d-f2fc9779-b3f6-4bec-8822-f5f6fe8041e0'),
 'add_d-a0be0541-c05e-46af-b8c5-df5fb17eea90': (&lt;function __main__.add_d(arr1, arr2)>,
  'sq_d-96134174-5594-4c11-bb93-b045188f8a65',
  'sq_d-57df3f05-4ad2-41b4-bf02-4f82ddcaa741'),
 ('array-93fac394d6028ca1841a0aaaf012fdfd', 0): array([1]),
 ('array-93fac394d6028ca1841a0aaaf012fdfd', 1): array([2]),
 ('array-93fac394d6028ca1841a0aaaf012fdfd', 2): array([3]),
 ('array-93fac394d6028ca1841a0aaaf012fdfd', 3): array([4]),
 'finalize-71ed3afe-61b1-46e5-8a49-2c36a9e8826f': (&lt;bound method DataArray._dask_finalize of &lt;class 'xarray.core.dataarray.DataArray'>>,
  [[('array-93fac394d6028ca1841a0aaaf012fdfd', 0),
    ('array-93fac394d6028ca1841a0aaaf012fdfd', 1),
    ('array-93fac394d6028ca1841a0aaaf012fdfd', 2),
    ('array-93fac394d6028ca1841a0aaaf012fdfd', 3)]],
  'array-93fac394d6028ca1841a0aaaf012fdfd',
  &lt;bound method Dataset._dask_postcompute of &lt;xarray.Dataset> Size: 32B
  Dimensions:       (dim_0: 4)
  Dimensions without coordinates: dim_0
  Data variables:
      &lt;this-array>  (dim_0) int64 32B dask.array&lt;chunksize=(1,), meta=np.ndarray>>),
 'sq_d-96134174-5594-4c11-bb93-b045188f8a65': (&lt;function __main__.sq_d(arr)>,
  'finalize-71ed3afe-61b1-46e5-8a49-2c36a9e8826f'),
 ('array-e0289449abd23dc644f0fd074cd695dc', 0): array([5]),
 ('array-e0289449abd23dc644f0fd074cd695dc', 1): array([6]),
 ('array-e0289449abd23dc644f0fd074cd695dc', 2): array([7]),
 ('array-e0289449abd23dc644f0fd074cd695dc', 3): array([8]),
 'finalize-89a5a21d-b67f-47b9-969d-bf82c9f632d6': (&lt;bound method DataArray._dask_finalize of &lt;class 'xarray.core.dataarray.DataArray'>>,
  [[('array-e0289449abd23dc644f0fd074cd695dc', 0),
    ('array-e0289449abd23dc644f0fd074cd695dc', 1),
    ('array-e0289449abd23dc644f0fd074cd695dc', 2),
    ('array-e0289449abd23dc644f0fd074cd695dc', 3)]],
  'array-e0289449abd23dc644f0fd074cd695dc',
  &lt;bound method Dataset._dask_postcompute of &lt;xarray.Dataset> Size: 32B
  Dimensions:       (dim_0: 4)
  Dimensions without coordinates: dim_0
  Data variables:
      &lt;this-array>  (dim_0) int64 32B dask.array&lt;chunksize=(1,), meta=np.ndarray>>),
 'sq_d-57df3f05-4ad2-41b4-bf02-4f82ddcaa741': (&lt;function __main__.sq_d(arr)>,
  'finalize-89a5a21d-b67f-47b9-969d-bf82c9f632d6'),
 'mul_d-f2fc9779-b3f6-4bec-8822-f5f6fe8041e0': (&lt;function __main__.mul_d(arr1, arr2)>,
  'finalize-8e4a37e5-68d7-4d57-908c-05611cb218a2',
  'finalize-abb81368-05d0-48fd-bc81-4da3d383a026'),
 'finalize-8e4a37e5-68d7-4d57-908c-05611cb218a2': (&lt;bound method DataArray._dask_finalize of &lt;class 'xarray.core.dataarray.DataArray'>>,
  [[('array-93fac394d6028ca1841a0aaaf012fdfd', 0),
    ('array-93fac394d6028ca1841a0aaaf012fdfd', 1),
    ('array-93fac394d6028ca1841a0aaaf012fdfd', 2),
    ('array-93fac394d6028ca1841a0aaaf012fdfd', 3)]],
  'array-93fac394d6028ca1841a0aaaf012fdfd',
  &lt;bound method Dataset._dask_postcompute of &lt;xarray.Dataset> Size: 32B
  Dimensions:       (dim_0: 4)
  Dimensions without coordinates: dim_0
  Data variables:
      &lt;this-array>  (dim_0) int64 32B dask.array&lt;chunksize=(1,), meta=np.ndarray>>),
 'finalize-abb81368-05d0-48fd-bc81-4da3d383a026': (&lt;bound method DataArray._dask_finalize of &lt;class 'xarray.core.dataarray.DataArray'>>,
  [[('array-e0289449abd23dc644f0fd074cd695dc', 0),
    ('array-e0289449abd23dc644f0fd074cd695dc', 1),
    ('array-e0289449abd23dc644f0fd074cd695dc', 2),
    ('array-e0289449abd23dc644f0fd074cd695dc', 3)]],
  'array-e0289449abd23dc644f0fd074cd695dc',
  &lt;bound method Dataset._dask_postcompute of &lt;xarray.Dataset> Size: 32B
  Dimensions:       (dim_0: 4)
  Dimensions without coordinates: dim_0
  Data variables:
      &lt;this-array>  (dim_0) int64 32B dask.array&lt;chunksize=(1,), meta=np.ndarray>>),
 'getattr-d83101a6b9634af52ae2ed30c7d8dba0': (&lt;function getattr>,
  'add-a362066893b349d99b2b19a5d658fccb',
  'data')}
</code></pre>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">client.get(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(delayed_hgl), </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'add-a362066893b349d99b2b19a5d658fccb'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># get(dict(delayed_hgl), 'add-a362066893b349d99b2b19a5d658fccb')</span></span></code></pre></figure>
<div><svg style="position:absolute;width:0;height:0;overflow:hidden;">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */
:root {
—xr-font-color0: var(—jp-content-font-color0, rgba(0, 0, 0, 1));
—xr-font-color2: var(—jp-content-font-color2, rgba(0, 0, 0, 0.54));
—xr-font-color3: var(—jp-content-font-color3, rgba(0, 0, 0, 0.38));
—xr-border-color: var(—jp-border-color2, e0e0e0</style>);
—xr-disabled-color: var(—jp-layout-color3, <a href="../../../../tags/bdbdbd" class="tag-link internal alias" data-slug="tags/bdbdbd">bdbdbd</a>);
—xr-background-color: var(—jp-layout-color0, white);
—xr-background-color-row-even: var(—jp-layout-color1, white);
—xr-background-color-row-odd: var(—jp-layout-color2, <a href="../../../../tags/eeeeee" class="tag-link internal alias" data-slug="tags/eeeeee">eeeeee</a>);
}<p></p>
<p>html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
—xr-font-color0: rgba(255, 255, 255, 1);
—xr-font-color2: rgba(255, 255, 255, 0.54);
—xr-font-color3: rgba(255, 255, 255, 0.38);
—xr-border-color: <a href="../../../../tags/1F1F1F" class="tag-link internal alias" data-slug="tags/1F1F1F">1F1F1F</a>;
—xr-disabled-color: #515151;
—xr-background-color: #111111;
—xr-background-color-row-even: #111111;
—xr-background-color-row-odd: #313131;
}</p>
<p>.xr-wrap {
display: block !important;
min-width: 300px;
max-width: 700px;
}</p>
<p>.xr-text-repr-fallback {
/* fallback to plain text repr when CSS is not injected (untrusted notebook) */
display: none;
}</p>
<p>.xr-header {
padding-top: 6px;
padding-bottom: 6px;
margin-bottom: 4px;
border-bottom: solid 1px var(—xr-border-color);
}</p>
<p>.xr-header > div,
.xr-header > ul {
display: inline;
margin-top: 0;
margin-bottom: 0;
}</p>
<p>.xr-obj-type,
.xr-array-name {
margin-left: 2px;
margin-right: 10px;
}</p>
<p>.xr-obj-type {
color: var(—xr-font-color2);
}</p>
<p>.xr-sections {
padding-left: 0 !important;
display: grid;
grid-template-columns: 150px auto auto 1fr 20px 20px;
}</p>
<p>.xr-section-item {
display: contents;
}</p>
<p>.xr-section-item input {
display: none;
}</p>
<p>.xr-section-item input + label {
color: var(—xr-disabled-color);
}</p>
<p>.xr-section-item input:enabled + label {
cursor: pointer;
color: var(—xr-font-color2);
}</p>
<p>.xr-section-item input:enabled + label:hover {
color: var(—xr-font-color0);
}</p>
<p>.xr-section-summary {
grid-column: 1;
color: var(—xr-font-color2);
font-weight: 500;
}</p>
<p>.xr-section-summary > span {
display: inline-block;
padding-left: 0.5em;
}</p>
<p>.xr-section-summary-in:disabled + label {
color: var(—xr-font-color2);
}</p>
<p>.xr-section-summary-in + label:before {
display: inline-block;
content: ’►’;
font-size: 11px;
width: 15px;
text-align: center;
}</p>
<p>.xr-section-summary-in:disabled + label:before {
color: var(—xr-disabled-color);
}</p>
<p>.xr-section-summary-in:checked + label:before {
content: ’▼’;
}</p>
<p>.xr-section-summary-in:checked + label > span {
display: none;
}</p>
<p>.xr-section-summary,
.xr-section-inline-details {
padding-top: 4px;
padding-bottom: 4px;
}</p>
<p>.xr-section-inline-details {
grid-column: 2 / -1;
}</p>
<p>.xr-section-details {
display: none;
grid-column: 1 / -1;
margin-bottom: 5px;
}</p>
<p>.xr-section-summary-in:checked ~ .xr-section-details {
display: contents;
}</p>
<p>.xr-array-wrap {
grid-column: 1 / -1;
display: grid;
grid-template-columns: 20px auto;
}</p>
<p>.xr-array-wrap > label {
grid-column: 1;
vertical-align: top;
}</p>
<p>.xr-preview {
color: var(—xr-font-color3);
}</p>
<p>.xr-array-preview,
.xr-array-data {
padding: 0 5px !important;
grid-column: 2;
}</p>
<p>.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
display: none;
}</p>
<p>.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
display: inline-block;
}</p>
<p>.xr-dim-list {
display: inline-block !important;
list-style: none;
padding: 0 !important;
margin: 0;
}</p>
<p>.xr-dim-list li {
display: inline-block;
padding: 0;
margin: 0;
}</p>
<p>.xr-dim-list:before {
content: ’(’;
}</p>
<p>.xr-dim-list:after {
content: ’)’;
}</p>
<p>.xr-dim-list li:not(:last-child):after {
content: ’,’;
padding-right: 5px;
}</p>
<p>.xr-has-index {
font-weight: bold;
}</p>
<p>.xr-var-list,
.xr-var-item {
display: contents;
}</p>
<p>.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
background-color: var(—xr-background-color-row-even);
margin-bottom: 0;
}</p>
<p>.xr-var-item > .xr-var-name:hover span {
padding-right: 5px;
}</p>
<p>.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
background-color: var(—xr-background-color-row-odd);
}</p>
<p>.xr-var-name {
grid-column: 1;
}</p>
<p>.xr-var-dims {
grid-column: 2;
}</p>
<p>.xr-var-dtype {
grid-column: 3;
text-align: right;
color: var(—xr-font-color2);
}</p>
<p>.xr-var-preview {
grid-column: 4;
}</p>
<p>.xr-index-preview {
grid-column: 2 / 5;
color: var(—xr-font-color2);
}</p>
<p>.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
padding-right: 10px;
}</p>
<p>.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
overflow: visible;
width: auto;
z-index: 1;
}</p>
<p>.xr-var-attrs,
.xr-var-data,
.xr-index-data {
display: none;
background-color: var(—xr-background-color) !important;
padding-bottom: 5px !important;
}</p>
<p>.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
display: block;
}</p>
<p>.xr-var-data > table {
float: right;
}</p>
<p>.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
padding-left: 25px !important;
}</p>
<p>.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
grid-column: 1 / -1;
}</p>
<p>dl.xr-attrs {
padding: 0;
margin: 0;
display: grid;
grid-template-columns: 125px auto;
}</p>
<p>.xr-attrs dt,
.xr-attrs dd {
padding: 0;
margin: 0;
float: left;
padding-right: 10px;
width: auto;
}</p>
<p>.xr-attrs dt {
font-weight: normal;
grid-column: 1;
}</p>
<p>.xr-attrs dt:hover span {
display: inline-block;
background: var(—xr-background-color);
padding-right: 10px;
}</p>
<p>.xr-attrs dd {
grid-column: 2;
white-space: pre-wrap;
word-break: break-all;
}</p>
<p>.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
display: inline-block;
vertical-align: middle;
width: 1em;
height: 1.5em !important;
stroke-width: 0;
stroke: currentColor;
fill: currentColor;
}
</p><pre class="xr-text-repr-fallback">&lt;xarray.DataArray (dim_0: 4)> Size: 32B
array([ 31,  52,  79, 112])
Dimensions without coordinates: dim_0</pre><div class="xr-wrap" style="display:none;"><div class="xr-header"><div class="xr-obj-type">xarray.DataArray</div><div class="xr-array-name"></div><ul class="xr-dim-list"><li><span>dim_0</span>: 4</li></ul></div><ul class="xr-sections"><li class="xr-section-item"><div class="xr-array-wrap"><input id="section-f5d2d0b3-29c8-4d17-8d00-84e90bb07fbc" class="xr-array-in" type="checkbox" checked/><label for="section-f5d2d0b3-29c8-4d17-8d00-84e90bb07fbc" title="Show/hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>31 52 79 112</span></div><div class="xr-array-data"><pre>array([ 31,  52,  79, 112])</pre></div></div></li><li class="xr-section-item"><input id="section-072b46a6-63d0-4888-a4e5-ddb8dd390f40" class="xr-section-summary-in" type="checkbox" disabled/><label for="section-072b46a6-63d0-4888-a4e5-ddb8dd390f40" class="xr-section-summary" title="Expand/collapse section">Coordinates: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-a972e63f-8fe3-4e2b-951c-a9ff59ed3c04" class="xr-section-summary-in" type="checkbox" disabled/><label for="section-a972e63f-8fe3-4e2b-951c-a9ff59ed3c04" class="xr-section-summary" title="Expand/collapse section">Indexes: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-e1d69b77-200e-43fc-b4e0-a02dcf5982cc" class="xr-section-summary-in" type="checkbox" disabled/><label for="section-e1d69b77-200e-43fc-b4e0-a02dcf5982cc" class="xr-section-summary" title="Expand/collapse section">Attributes: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"></dl></div></li></ul></div></div><p></p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">delayed_hgl</span></span></code></pre></figure>
<div>
    <div>
        <div style="width:52px;height:52px;position:absolute;">
            <svg width="76" height="71" viewBox="0 0 76 71" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="61.5" cy="36.5" r="13.5" style="stroke:var(--jp-ui-font-color2, #1D1D1D);fill:var(--jp-layout-color1, #F2F2F2);" stroke-width="2"></circle>
                <circle cx="14.5" cy="14.5" r="13.5" style="stroke:var(--jp-ui-font-color2, #1D1D1D);fill:var(--jp-layout-color1, #F2F2F2);" stroke-width="2"></circle>
                <circle cx="14.5" cy="56.5" r="13.5" style="stroke:var(--jp-ui-font-color2, #1D1D1D);fill:var(--jp-layout-color1, #F2F2F2);" stroke-width="2"></circle>
                <path d="M28 16L30.5 16C33.2614 16 35.5 18.2386 35.5 21L35.5 32.0001C35.5 34.7615 37.7386 37.0001 40.5 37.0001L43 37.0001" style="stroke:var(--jp-ui-font-color2, #1D1D1D);" stroke-width="1.5"></path>
                <path d="M40.5 37L40.5 37.75L40.5 37.75L40.5 37ZM35.5 42L36.25 42L35.5 42ZM35.5 52L34.75 52L35.5 52ZM30.5 57L30.5 57.75L30.5 57ZM41.5001 36.25L40.5 36.25L40.5 37.75L41.5001 37.75L41.5001 36.25ZM34.75 42L34.75 52L36.25 52L36.25 42L34.75 42ZM30.5 56.25L28.0001 56.25L28.0001 57.75L30.5 57.75L30.5 56.25ZM34.75 52C34.75 54.3472 32.8472 56.25 30.5 56.25L30.5 57.75C33.6756 57.75 36.25 55.1756 36.25 52L34.75 52ZM40.5 36.25C37.3244 36.25 34.75 38.8243 34.75 42L36.25 42C36.25 39.6528 38.1528 37.75 40.5 37.75L40.5 36.25Z" style="fill:var(--jp-ui-font-color2, #1D1D1D);"></path>
                <circle cx="28" cy="16" r="2.25" fill="#E5E5E5" style="stroke:var(--jp-ui-font-color2, #1D1D1D);" stroke-width="1.5"></circle>
                <circle cx="28" cy="57" r="2.25" fill="#E5E5E5" style="stroke:var(--jp-ui-font-color2, #1D1D1D);" stroke-width="1.5"></circle>
                <path d="M45.25 36.567C45.5833 36.7594 45.5833 37.2406 45.25 37.433L42.25 39.1651C41.9167 39.3575 41.5 39.117 41.5 38.7321V35.2679C41.5 34.883 41.9167 34.6425 42.25 34.8349L45.25 36.567Z" style="fill:var(--jp-ui-font-color2, #1D1D1D);"></path>
            </svg>
        </div>
        <div style="margin-left:64px;">
            <h3 style="margin-bottom:0px;" id="highlevelgraph-1">HighLevelGraph<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#highlevelgraph-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
            <p style="color:var(--jp-ui-font-color2, #5D5851);margin-bottom:0px;">
                HighLevelGraph with 12 layers and 18 keys from all layers.
            </p>
<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer1: array&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        array-e0289449abd23dc644f0fd074cd695dc
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>MaterializedLayer&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>4&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>shape&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(4,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>dtype&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>int64&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunksize&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(1,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>dask.array.core.Array&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunk_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>numpy.ndarray&lt;/td>
                &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>
            &lt;svg width=&quot;250&quot; height=&quot;121&quot; style=&quot;stroke:rgb(0,0,0);stroke-width:1&quot; >
</code></pre>
  
  <line x1="0" y1="0" x2="200" y2="0" style="stroke-width:2;">
  <line x1="0" y1="71" x2="200" y2="71" style="stroke-width:2;">
  
  <line x1="0" y1="0" x2="0" y2="71" style="stroke-width:2;">
  <line x1="50" y1="0" x2="50" y2="71">
  <line x1="100" y1="0" x2="100" y2="71">
  <line x1="150" y1="0" x2="150" y2="71">
  <line x1="200" y1="0" x2="200" y2="71" style="stroke-width:2;">
  
  <polygon points="0.0,0.0 200.0,0.0 200.0,71.49799253643671 0.0,71.49799253643671" style="fill:#ECB172A0;stroke-width:0;">
  
<p><text x="100.000000" y="91.497993" font-size="1.0rem" font-weight="100" text-anchor="middle">4</text>
<text x="220.000000" y="35.748996" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,220.000000,35.748996)">1</text>



</p>
<pre><code>&lt;/details>
</code></pre>
</polygon></line></line></line></line></line></line></line></div>
<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer2: finalize&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        finalize-abb81368-05d0-48fd-bc81-4da3d383a026
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>MaterializedLayer&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>1&lt;/td>
                &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;> depends on &lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>array-e0289449abd23dc644f0fd074cd695dc&lt;/td>
                    &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>

        &lt;/td>
    &lt;/tr>
    &lt;/table>

&lt;/details>
</code></pre>
</div>
<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer3: finalize&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        finalize-89a5a21d-b67f-47b9-969d-bf82c9f632d6
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>MaterializedLayer&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>1&lt;/td>
                &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;> depends on &lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>array-e0289449abd23dc644f0fd074cd695dc&lt;/td>
                    &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>

        &lt;/td>
    &lt;/tr>
    &lt;/table>

&lt;/details>
</code></pre>
</div>
<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer4: sq_d&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        sq_d-57df3f05-4ad2-41b4-bf02-4f82ddcaa741
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>MaterializedLayer&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>1&lt;/td>
                &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;> depends on &lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>finalize-89a5a21d-b67f-47b9-969d-bf82c9f632d6&lt;/td>
                    &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>

        &lt;/td>
    &lt;/tr>
    &lt;/table>

&lt;/details>
</code></pre>

<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer5: array&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        array-93fac394d6028ca1841a0aaaf012fdfd
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>MaterializedLayer&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>4&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>shape&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(4,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>dtype&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>int64&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunksize&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>(1,)&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>dask.array.core.Array&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>chunk_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>numpy.ndarray&lt;/td>
                &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>
            &lt;svg width=&quot;250&quot; height=&quot;121&quot; style=&quot;stroke:rgb(0,0,0);stroke-width:1&quot; >
</code></pre>
  
  <line x1="0" y1="0" x2="200" y2="0" style="stroke-width:2;">
  <line x1="0" y1="71" x2="200" y2="71" style="stroke-width:2;">
  
  <line x1="0" y1="0" x2="0" y2="71" style="stroke-width:2;">
  <line x1="50" y1="0" x2="50" y2="71">
  <line x1="100" y1="0" x2="100" y2="71">
  <line x1="150" y1="0" x2="150" y2="71">
  <line x1="200" y1="0" x2="200" y2="71" style="stroke-width:2;">
  
  <polygon points="0.0,0.0 200.0,0.0 200.0,71.49799253643671 0.0,71.49799253643671" style="fill:#ECB172A0;stroke-width:0;">
  
<p><text x="100.000000" y="91.497993" font-size="1.0rem" font-weight="100" text-anchor="middle">4</text>
<text x="220.000000" y="35.748996" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,220.000000,35.748996)">1</text>



</p>
<pre><code>&lt;/details>
</code></pre>

<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer6: finalize&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        finalize-8e4a37e5-68d7-4d57-908c-05611cb218a2
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>MaterializedLayer&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>1&lt;/td>
                &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;> depends on &lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>array-93fac394d6028ca1841a0aaaf012fdfd&lt;/td>
                    &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>

        &lt;/td>
    &lt;/tr>
    &lt;/table>

&lt;/details>
</code></pre>

<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer7: mul_d&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        mul_d-f2fc9779-b3f6-4bec-8822-f5f6fe8041e0
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>MaterializedLayer&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>1&lt;/td>
                &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;> depends on &lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>finalize-8e4a37e5-68d7-4d57-908c-05611cb218a2&lt;/td>
                    &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;>&lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>finalize-abb81368-05d0-48fd-bc81-4da3d383a026&lt;/td>
                    &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>

        &lt;/td>
    &lt;/tr>
    &lt;/table>

&lt;/details>
</code></pre>

<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer8: finalize&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        finalize-71ed3afe-61b1-46e5-8a49-2c36a9e8826f
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>MaterializedLayer&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>1&lt;/td>
                &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;> depends on &lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>array-93fac394d6028ca1841a0aaaf012fdfd&lt;/td>
                    &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>

        &lt;/td>
    &lt;/tr>
    &lt;/table>

&lt;/details>
</code></pre>

<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer9: sq_d&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        sq_d-96134174-5594-4c11-bb93-b045188f8a65
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>MaterializedLayer&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>1&lt;/td>
                &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;> depends on &lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>finalize-71ed3afe-61b1-46e5-8a49-2c36a9e8826f&lt;/td>
                    &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>

        &lt;/td>
    &lt;/tr>
    &lt;/table>

&lt;/details>
</code></pre>

<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer10: add_d&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        add_d-a0be0541-c05e-46af-b8c5-df5fb17eea90
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>MaterializedLayer&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>1&lt;/td>
                &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;> depends on &lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>sq_d-57df3f05-4ad2-41b4-bf02-4f82ddcaa741&lt;/td>
                    &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;>&lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>sq_d-96134174-5594-4c11-bb93-b045188f8a65&lt;/td>
                    &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>

        &lt;/td>
    &lt;/tr>
    &lt;/table>

&lt;/details>
</code></pre>

<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer11: add&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        add-a362066893b349d99b2b19a5d658fccb
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>MaterializedLayer&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>1&lt;/td>
                &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;> depends on &lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>add_d-a0be0541-c05e-46af-b8c5-df5fb17eea90&lt;/td>
                    &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;>&lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>mul_d-f2fc9779-b3f6-4bec-8822-f5f6fe8041e0&lt;/td>
                    &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>

        &lt;/td>
    &lt;/tr>
    &lt;/table>

&lt;/details>
</code></pre>

<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer12: getattr&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        getattr-d83101a6b9634af52ae2ed30c7d8dba0
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>MaterializedLayer&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>1&lt;/td>
                &lt;/tr>



                    &lt;tr>
                        &lt;th style=&quot;text-align: left; width: 150px;&quot;> depends on &lt;/th>
                        &lt;td style=&quot;text-align: left;&quot;>add-a362066893b349d99b2b19a5d658fccb&lt;/td>
                    &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>

        &lt;/td>
    &lt;/tr>
    &lt;/table>

&lt;/details>
</code></pre>

<pre><code>    &lt;/div>
&lt;/div>
</code></pre>

<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">delayed_hgl.layers</span></span></code></pre></figure>
<pre><code>{'add-a362066893b349d99b2b19a5d658fccb': &lt;dask.highlevelgraph.MaterializedLayer at 0x16447ceb0>,
 'add_d-a0be0541-c05e-46af-b8c5-df5fb17eea90': &lt;dask.highlevelgraph.MaterializedLayer at 0x16447cc10>,
 'array-93fac394d6028ca1841a0aaaf012fdfd': &lt;dask.highlevelgraph.MaterializedLayer at 0x164d21930>,
 'finalize-71ed3afe-61b1-46e5-8a49-2c36a9e8826f': &lt;dask.highlevelgraph.MaterializedLayer at 0x164d8c8e0>,
 'sq_d-96134174-5594-4c11-bb93-b045188f8a65': &lt;dask.highlevelgraph.MaterializedLayer at 0x164d22920>,
 'array-e0289449abd23dc644f0fd074cd695dc': &lt;dask.highlevelgraph.MaterializedLayer at 0x164d8c1f0>,
 'finalize-89a5a21d-b67f-47b9-969d-bf82c9f632d6': &lt;dask.highlevelgraph.MaterializedLayer at 0x164d8ca00>,
 'sq_d-57df3f05-4ad2-41b4-bf02-4f82ddcaa741': &lt;dask.highlevelgraph.MaterializedLayer at 0x108e85c30>,
 'mul_d-f2fc9779-b3f6-4bec-8822-f5f6fe8041e0': &lt;dask.highlevelgraph.MaterializedLayer at 0x16447d2a0>,
 'finalize-8e4a37e5-68d7-4d57-908c-05611cb218a2': &lt;dask.highlevelgraph.MaterializedLayer at 0x164d8dd20>,
 'finalize-abb81368-05d0-48fd-bc81-4da3d383a026': &lt;dask.highlevelgraph.MaterializedLayer at 0x164d8dd50>,
 'getattr-d83101a6b9634af52ae2ed30c7d8dba0': &lt;dask.highlevelgraph.MaterializedLayer at 0x16447d000>}
</code></pre>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dask.optimization </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fuse, fuse_linear</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dask.highlevelgraph </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HighLevelGraph</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># print(delayed_hgl.layers)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sel_layers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> delayed_hgl.layers</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">merged_hgl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> delayed_hgl.merge(sel_layers)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># print(dict(merged_hgl))</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">get(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(merged_hgl),</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'add-a362066893b349d99b2b19a5d658fccb'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> )</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># delayed_hgl.__dir__()</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># help(HighLevelGraph.validate)</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dask.distributed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Client</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Client(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tcp://192.168.0.100:8786&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># help(dask.distributed.get)</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># get(dict(merged_hgl) , 'add-a362066893b349d99b2b19a5d658fccb' )</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># print(delayed_hgl.validate())</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(merged_hgl)</span></span></code></pre></figure>
<pre><code>{'add-a362066893b349d99b2b19a5d658fccb': &lt;dask.highlevelgraph.MaterializedLayer at 0x16447ceb0>,
 'add_d-a0be0541-c05e-46af-b8c5-df5fb17eea90': &lt;dask.highlevelgraph.MaterializedLayer at 0x16447cc10>,
 'array-93fac394d6028ca1841a0aaaf012fdfd': &lt;dask.highlevelgraph.MaterializedLayer at 0x164d21930>,
 'finalize-71ed3afe-61b1-46e5-8a49-2c36a9e8826f': &lt;dask.highlevelgraph.MaterializedLayer at 0x164d8c8e0>,
 'sq_d-96134174-5594-4c11-bb93-b045188f8a65': &lt;dask.highlevelgraph.MaterializedLayer at 0x164d22920>,
 'array-e0289449abd23dc644f0fd074cd695dc': &lt;dask.highlevelgraph.MaterializedLayer at 0x164d8c1f0>,
 'finalize-89a5a21d-b67f-47b9-969d-bf82c9f632d6': &lt;dask.highlevelgraph.MaterializedLayer at 0x164d8ca00>,
 'sq_d-57df3f05-4ad2-41b4-bf02-4f82ddcaa741': &lt;dask.highlevelgraph.MaterializedLayer at 0x108e85c30>,
 'mul_d-f2fc9779-b3f6-4bec-8822-f5f6fe8041e0': &lt;dask.highlevelgraph.MaterializedLayer at 0x16447d2a0>,
 'finalize-8e4a37e5-68d7-4d57-908c-05611cb218a2': &lt;dask.highlevelgraph.MaterializedLayer at 0x164d8dd20>,
 'finalize-abb81368-05d0-48fd-bc81-4da3d383a026': &lt;dask.highlevelgraph.MaterializedLayer at 0x164d8dd50>,
 'getattr-d83101a6b9634af52ae2ed30c7d8dba0': &lt;dask.highlevelgraph.MaterializedLayer at 0x16447d000>}
</code></pre>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ml </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client.get(merged_hgl,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'add-a362066893b349d99b2b19a5d658fccb'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ml.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">__dir__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></figure>
<pre><code>['annotations',
 'collection_annotations',
 'mapping',
 '__module__',
 '__doc__',
 '__init__',
 '__contains__',
 '__getitem__',
 '__iter__',
 '__len__',
 'is_materialized',
 'get_output_keys',
 '__abstractmethods__',
 '_abc_impl',
 '__slotnames__',
 '__annotations__',
 'cull',
 'get_dependencies',
 'clone',
 '__copy__',
 '_repr_html_',
 'layer_info_dict',
 '__orig_bases__',
 '__dict__',
 '__weakref__',
 '__slots__',
 'get',
 'keys',
 'items',
 'values',
 '__eq__',
 '__reversed__',
 '__hash__',
 '__subclasshook__',
 '__new__',
 '__repr__',
 '__str__',
 '__getattribute__',
 '__setattr__',
 '__delattr__',
 '__lt__',
 '__le__',
 '__ne__',
 '__gt__',
 '__ge__',
 '__reduce_ex__',
 '__reduce__',
 '__init_subclass__',
 '__format__',
 '__sizeof__',
 '__dir__',
 '__class__',
 '__class_getitem__']
</code></pre>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ml)</span></span></code></pre></figure>
<pre><code>{'add-a362066893b349d99b2b19a5d658fccb': (&lt;function _operator.add(a, b, /)>,
  'add_d-a0be0541-c05e-46af-b8c5-df5fb17eea90',
  'mul_d-f2fc9779-b3f6-4bec-8822-f5f6fe8041e0')}
</code></pre>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">merged_hgl</span></span></code></pre></figure>
<div>
    <div>
        <div style="width:52px;height:52px;position:absolute;">
            <svg width="76" height="71" viewBox="0 0 76 71" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="61.5" cy="36.5" r="13.5" style="stroke:var(--jp-ui-font-color2, #1D1D1D);fill:var(--jp-layout-color1, #F2F2F2);" stroke-width="2"></circle>
                <circle cx="14.5" cy="14.5" r="13.5" style="stroke:var(--jp-ui-font-color2, #1D1D1D);fill:var(--jp-layout-color1, #F2F2F2);" stroke-width="2"></circle>
                <circle cx="14.5" cy="56.5" r="13.5" style="stroke:var(--jp-ui-font-color2, #1D1D1D);fill:var(--jp-layout-color1, #F2F2F2);" stroke-width="2"></circle>
                <path d="M28 16L30.5 16C33.2614 16 35.5 18.2386 35.5 21L35.5 32.0001C35.5 34.7615 37.7386 37.0001 40.5 37.0001L43 37.0001" style="stroke:var(--jp-ui-font-color2, #1D1D1D);" stroke-width="1.5"></path>
                <path d="M40.5 37L40.5 37.75L40.5 37.75L40.5 37ZM35.5 42L36.25 42L35.5 42ZM35.5 52L34.75 52L35.5 52ZM30.5 57L30.5 57.75L30.5 57ZM41.5001 36.25L40.5 36.25L40.5 37.75L41.5001 37.75L41.5001 36.25ZM34.75 42L34.75 52L36.25 52L36.25 42L34.75 42ZM30.5 56.25L28.0001 56.25L28.0001 57.75L30.5 57.75L30.5 56.25ZM34.75 52C34.75 54.3472 32.8472 56.25 30.5 56.25L30.5 57.75C33.6756 57.75 36.25 55.1756 36.25 52L34.75 52ZM40.5 36.25C37.3244 36.25 34.75 38.8243 34.75 42L36.25 42C36.25 39.6528 38.1528 37.75 40.5 37.75L40.5 36.25Z" style="fill:var(--jp-ui-font-color2, #1D1D1D);"></path>
                <circle cx="28" cy="16" r="2.25" fill="#E5E5E5" style="stroke:var(--jp-ui-font-color2, #1D1D1D);" stroke-width="1.5"></circle>
                <circle cx="28" cy="57" r="2.25" fill="#E5E5E5" style="stroke:var(--jp-ui-font-color2, #1D1D1D);" stroke-width="1.5"></circle>
                <path d="M45.25 36.567C45.5833 36.7594 45.5833 37.2406 45.25 37.433L42.25 39.1651C41.9167 39.3575 41.5 39.117 41.5 38.7321V35.2679C41.5 34.883 41.9167 34.6425 42.25 34.8349L45.25 36.567Z" style="fill:var(--jp-ui-font-color2, #1D1D1D);"></path>
            </svg>
        </div>
        <div style="margin-left:64px;">
            <h3 style="margin-bottom:0px;" id="highlevelgraph-2">HighLevelGraph<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#highlevelgraph-2" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
            <p style="color:var(--jp-ui-font-color2, #5D5851);margin-bottom:0px;">
                HighLevelGraph with 1 layers and 12 keys from all layers.
            </p>
<pre><code>        &lt;div style=&quot;&quot;>
&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 32 32&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; style=&quot;position: absolute;&quot;>

    &lt;circle cx=&quot;16&quot; cy=&quot;16&quot; r=&quot;14&quot; fill=&quot;#8F8F8F&quot; style=&quot;stroke: var(--jp-ui-font-color2, #1D1D1D);&quot; stroke-width=&quot;2&quot;/>

&lt;/svg>

&lt;details style=&quot;margin-left: 32px;&quot;>
    &lt;summary style=&quot;margin-bottom: 10px; margin-top: 10px;&quot;>
        &lt;h4 style=&quot;display: inline;&quot;>Layer1: 5977389568&lt;/h4>
    &lt;/summary>
    &lt;p style=&quot;color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;&quot;>
        5977389568
    &lt;/p>

    &lt;table>
    &lt;tr>
        &lt;td>
            &lt;table>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>layer_type&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>MaterializedLayer&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>is_materialized&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>True&lt;/td>
                &lt;/tr>

                &lt;tr>
                    &lt;th style=&quot;text-align: left; width: 150px;&quot;>number of outputs&lt;/th>
                    &lt;td style=&quot;text-align: left;&quot;>12&lt;/td>
                &lt;/tr>


            &lt;/table>
        &lt;/td>
        &lt;td>

        &lt;/td>
    &lt;/tr>
    &lt;/table>

&lt;/details>
</code></pre>
</div>
<pre><code>    &lt;/div>
&lt;/div>
</code></pre>
</div>
<h3 id="dask-custom-graph">Dask Custom Graph<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#dask-custom-graph" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">custom_graph </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;print&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dask.threaded </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> get</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">get(custom_graph, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'print'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></figure>
<pre><code>hello
</code></pre>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> res.data.dask</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dask_layers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> graph.layers</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">extr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> graph._all_external_keys</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">extr</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">layers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> graph.layers</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">layers[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'add-ffe880f167c9131320013be9069dfca1'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">__dir__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></figure>
<pre><code>['annotations',
 'collection_annotations',
 'output',
 'output_indices',
 'output_blocks',
 'dsk',
 'numblocks',
 'io_deps',
 'indices',
 'concatenate',
 'new_axes',
 '_dims',
 '_cached_dict',
 '__module__',
 '__annotations__',
 '__doc__',
 '__init__',
 'dims',
 '__repr__',
 '_dict',
 'get_output_keys',
 '__getitem__',
 '__iter__',
 '__len__',
 'is_materialized',
 '_cull_dependencies',
 '_cull',
 'cull',
 'clone',
 '__abstractmethods__',
 '_abc_impl',
 'get_dependencies',
 '__copy__',
 '_repr_html_',
 'layer_info_dict',
 '__orig_bases__',
 '__dict__',
 '__weakref__',
 '__slots__',
 'get',
 '__contains__',
 'keys',
 'items',
 'values',
 '__eq__',
 '__reversed__',
 '__hash__',
 '__subclasshook__',
 '__new__',
 '__str__',
 '__getattribute__',
 '__setattr__',
 '__delattr__',
 '__lt__',
 '__le__',
 '__ne__',
 '__gt__',
 '__ge__',
 '__reduce_ex__',
 '__reduce__',
 '__init_subclass__',
 '__format__',
 '__sizeof__',
 '__dir__',
 '__class__',
 '__class_getitem__']
</code></pre>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(graph).keys()</span></span></code></pre></figure>
<pre><code>dict_keys([('add-ffe880f167c9131320013be9069dfca1', 0), ('add-ffe880f167c9131320013be9069dfca1', 1), ('add-ffe880f167c9131320013be9069dfca1', 2), ('add-ffe880f167c9131320013be9069dfca1', 3), ('add-d8368b0c413b7b1ff3e4545d5d219543', 0), ('add-d8368b0c413b7b1ff3e4545d5d219543', 1), ('add-d8368b0c413b7b1ff3e4545d5d219543', 2), ('add-d8368b0c413b7b1ff3e4545d5d219543', 3), ('array-93fac394d6028ca1841a0aaaf012fdfd', 0), ('array-93fac394d6028ca1841a0aaaf012fdfd', 1), ('array-93fac394d6028ca1841a0aaaf012fdfd', 2), ('array-93fac394d6028ca1841a0aaaf012fdfd', 3), ('pow-f98325ba6ded8b13c46607d966ba51d1', 0), ('pow-f98325ba6ded8b13c46607d966ba51d1', 1), ('pow-f98325ba6ded8b13c46607d966ba51d1', 2), ('pow-f98325ba6ded8b13c46607d966ba51d1', 3), ('array-e0289449abd23dc644f0fd074cd695dc', 0), ('array-e0289449abd23dc644f0fd074cd695dc', 1), ('array-e0289449abd23dc644f0fd074cd695dc', 2), ('array-e0289449abd23dc644f0fd074cd695dc', 3), ('pow-5022bc0a56d6e28f1fd172a750ba8cff', 0), ('pow-5022bc0a56d6e28f1fd172a750ba8cff', 1), ('pow-5022bc0a56d6e28f1fd172a750ba8cff', 2), ('pow-5022bc0a56d6e28f1fd172a750ba8cff', 3), ('mul-8e9e32e19f9c6e612b3800864d8cc810', 0), ('mul-8e9e32e19f9c6e612b3800864d8cc810', 1), ('mul-8e9e32e19f9c6e612b3800864d8cc810', 2), ('mul-8e9e32e19f9c6e612b3800864d8cc810', 3)])
</code></pre>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(graph):</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(get(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(graph), i))</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 31,  52,  79, 112</span></span></code></pre></figure>
<pre><code>[31]
[52]
[79]
[112]
[26]
[40]
[58]
[80]
[1]
[2]
[3]
[4]
[1]
[4]
[9]
[16]
[5]
[6]
[7]
[8]
[25]
[36]
[49]
[64]
[5]
[12]
[21]
[32]
</code></pre>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> extr:</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(get(extr, i[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]))</span></span></code></pre></figure>
<pre><code>3
0
2
2
1
2
1
3
0
3
2
2
2
2
1
2
0
2
1
3
3
0
2
2
3
2
3
3
</code></pre>
<h3 id="xarray-vs-numpy-on-delayed">xarray vs Numpy on delayed<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#xarray-vs-numpy-on-delayed" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line> </span></code></pre></figure>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line> </span></code></pre></figure></div></polygon></line></line></line></line></line></line></line></polygon></line></line></line></line></line></line></line></polygon></line></line></line></line></line></line></line></polygon></line></line></line></line></line></line></line></polygon></line></line></line></line></line></line></line></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div class="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false,&quot;enableRadial&quot;:false}"></div><button class="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div class="global-graph-outer"><div class="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.2,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true,&quot;enableRadial&quot;:true}"></div></div></div><div class="toc desktop-only"><button type="button" class="toc-header" aria-controls="toc-content" aria-expanded="true"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><ul class="toc-content overflow" id="list-1"><li class="depth-0"><a href="#observations" data-for="observations">Observations</a></li><li class="depth-0"><a href="#fuse-and-highlevelgraph" data-for="fuse-and-highlevelgraph">Fuse and HighLevelGraph</a></li><li class="depth-0"><a href="#call-delayed-on-hlg" data-for="call-delayed-on-hlg">Call delayed on HLG</a></li><li class="depth-0"><a href="#dask-delayed-and-fuse" data-for="dask-delayed-and-fuse">dask delayed and fuse</a></li><li class="depth-0"><a href="#dask-custom-graph" data-for="dask-custom-graph">Dask Custom Graph</a></li><li class="depth-0"><a href="#xarray-vs-numpy-on-delayed" data-for="xarray-vs-numpy-on-delayed">xarray vs Numpy on delayed</a></li><li class="overflow-end"></li></ul></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.5.0</a> © 2025</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></div></body><script type="application/javascript">function o(){let t=this.parentElement;t.classList.toggle("is-collapsed");let e=t.classList.contains("is-collapsed")?this.scrollHeight:t.scrollHeight;t.style.maxHeight=e+"px";let c=t,l=t.parentElement;for(;l;){if(!l.classList.contains("callout"))return;let i=l.classList.contains("is-collapsed")?l.scrollHeight:l.scrollHeight+c.scrollHeight;l.style.maxHeight=i+"px",c=l,l=l.parentElement}}function n(){let t=document.getElementsByClassName("callout is-collapsible");for(let s of t){let e=s.firstElementChild;if(!e)continue;e.addEventListener("click",o),window.addCleanup(()=>e.removeEventListener("click",o));let l=s.classList.contains("is-collapsed")?e.scrollHeight:s.scrollHeight;s.style.maxHeight=l+"px"}}document.addEventListener("nav",n);
</script><script type="module">function f(i,e){if(!i)return;function r(o){o.target===this&&(o.preventDefault(),o.stopPropagation(),e())}function t(o){o.key.startsWith("Esc")&&(o.preventDefault(),e())}i?.addEventListener("click",r),window.addCleanup(()=>i?.removeEventListener("click",r)),document.addEventListener("keydown",t),window.addCleanup(()=>document.removeEventListener("keydown",t))}function y(i){for(;i.firstChild;)i.removeChild(i.firstChild)}var h=class{constructor(e,r){this.container=e;this.content=r;this.setupEventListeners(),this.setupNavigationControls(),this.resetTransform()}isDragging=!1;startPan={x:0,y:0};currentPan={x:0,y:0};scale=1;MIN_SCALE=.5;MAX_SCALE=3;cleanups=[];setupEventListeners(){let e=this.onMouseDown.bind(this),r=this.onMouseMove.bind(this),t=this.onMouseUp.bind(this),o=this.resetTransform.bind(this);this.container.addEventListener("mousedown",e),document.addEventListener("mousemove",r),document.addEventListener("mouseup",t),window.addEventListener("resize",o),this.cleanups.push(()=>this.container.removeEventListener("mousedown",e),()=>document.removeEventListener("mousemove",r),()=>document.removeEventListener("mouseup",t),()=>window.removeEventListener("resize",o))}cleanup(){for(let e of this.cleanups)e()}setupNavigationControls(){let e=document.createElement("div");e.className="mermaid-controls";let r=this.createButton("+",()=>this.zoom(.1)),t=this.createButton("-",()=>this.zoom(-.1)),o=this.createButton("Reset",()=>this.resetTransform());e.appendChild(t),e.appendChild(o),e.appendChild(r),this.container.appendChild(e)}createButton(e,r){let t=document.createElement("button");return t.textContent=e,t.className="mermaid-control-button",t.addEventListener("click",r),window.addCleanup(()=>t.removeEventListener("click",r)),t}onMouseDown(e){e.button===0&&(this.isDragging=!0,this.startPan={x:e.clientX-this.currentPan.x,y:e.clientY-this.currentPan.y},this.container.style.cursor="grabbing")}onMouseMove(e){this.isDragging&&(e.preventDefault(),this.currentPan={x:e.clientX-this.startPan.x,y:e.clientY-this.startPan.y},this.updateTransform())}onMouseUp(){this.isDragging=!1,this.container.style.cursor="grab"}zoom(e){let r=Math.min(Math.max(this.scale+e,this.MIN_SCALE),this.MAX_SCALE),t=this.content.getBoundingClientRect(),o=t.width/2,n=t.height/2,c=r-this.scale;this.currentPan.x-=o*c,this.currentPan.y-=n*c,this.scale=r,this.updateTransform()}updateTransform(){this.content.style.transform=`translate(${this.currentPan.x}px, ${this.currentPan.y}px) scale(${this.scale})`}resetTransform(){this.scale=1;let e=this.content.querySelector("svg");this.currentPan={x:e.getBoundingClientRect().width/2,y:e.getBoundingClientRect().height/2},this.updateTransform()}},C=["--secondary","--tertiary","--gray","--light","--lightgray","--highlight","--dark","--darkgray","--codeFont"],E;document.addEventListener("nav",async()=>{let e=document.querySelector(".center").querySelectorAll("code.mermaid");if(e.length===0)return;E||=await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.esm.min.mjs");let r=E.default,t=new WeakMap;for(let n of e)t.set(n,n.innerText);async function o(){for(let s of e){s.removeAttribute("data-processed");let a=t.get(s);a&&(s.innerHTML=a)}let n=C.reduce((s,a)=>(s[a]=window.getComputedStyle(document.documentElement).getPropertyValue(a),s),{}),c=document.documentElement.getAttribute("saved-theme")==="dark";r.initialize({startOnLoad:!1,securityLevel:"loose",theme:c?"dark":"base",themeVariables:{fontFamily:n["--codeFont"],primaryColor:n["--light"],primaryTextColor:n["--darkgray"],primaryBorderColor:n["--tertiary"],lineColor:n["--darkgray"],secondaryColor:n["--secondary"],tertiaryColor:n["--tertiary"],clusterBkg:n["--light"],edgeLabelBackground:n["--highlight"]}}),await r.run({nodes:e})}await o(),document.addEventListener("themechange",o),window.addCleanup(()=>document.removeEventListener("themechange",o));for(let n=0;n<e.length;n++){let v=function(){let g=l.querySelector("#mermaid-space"),m=l.querySelector(".mermaid-content");if(!m)return;y(m);let w=c.querySelector("svg").cloneNode(!0);m.appendChild(w),l.classList.add("active"),g.style.cursor="grab",u=new h(g,m)},M=function(){l.classList.remove("active"),u?.cleanup(),u=null},c=e[n],s=c.parentElement,a=s.querySelector(".clipboard-button"),d=s.querySelector(".expand-button"),p=window.getComputedStyle(a),L=a.offsetWidth+parseFloat(p.marginLeft||"0")+parseFloat(p.marginRight||"0");d.style.right=`calc(${L}px + 0.3rem)`,s.prepend(d);let l=s.querySelector("#mermaid-container");if(!l)return;let u=null;d.addEventListener("click",v),f(l,M),window.addCleanup(()=>{u?.cleanup(),d.removeEventListener("click",v)})}});
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script src="../../../../postscript.js" type="module"></script></html>